<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[My Octopress Blog]]></title>
  <link href="http://okckd.github.io/atom.xml" rel="self"/>
  <link href="http://okckd.github.io/"/>
  <updated>2014-08-08T21:52:35+08:00</updated>
  <id>http://okckd.github.io/</id>
  <author>
    <name><![CDATA[Your Name]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[Design] Thread Pool Pattern]]></title>
    <link href="http://okckd.github.io/blog/2014/08/08/Thread-pool-pattern/"/>
    <updated>2014-08-08T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/08/Thread-pool-pattern</id>
    <content type="html"><![CDATA[<h3>Overview</h3>

<p><a href="http://programmers.stackexchange.com/a/173580">Thread pool</a> is a collection of managed threads usually organized in a queue, which execute the tasks in the task queue.</p>

<p><img class="middle" src="http://okckd.github.io/assets/images/thread-pool.png"></p>

<p><a href="http://en.wikipedia.org/wiki/Thread_pool_pattern">A sample thread pool</a> (green boxes) with waiting tasks (blue) and completed tasks (yellow)</p>

<h3>Why Thread Pool?</h3>

<p><a href="http://www.ibm.com/developerworks/library/j-jtp0730/">Many server applications</a>, such as <strong>Web servers (eg. Tomcat)</strong>, database servers, file servers, or mail servers must process a large number of tasks received from a network protocol. Often, the task is short-lived and the number of requests is large.</p>

<p><strong>Thread Pools are useful when you need to limit the number of threads</strong> running in your application at the same time.</p>

<h3>More details</h3>

<p>A thread pool is a group of pre-instantiated, idle threads which stand ready to be given work. These are preferred over instantiating new threads for each task when there is <strong>a large number of short tasks</strong> to be done <strong>rather than a small number of long ones</strong>.</p>

<p>Instead of starting a new thread for every task to execute concurrently, the <strong>task can be passed to a thread pool</strong>. As soon as the pool has any idle threads the task is assigned to one of them and executed.</p>

<p>Thread pools are often used in multi threaded servers. Each connection <strong>arriving at the server via the network is wrapped as a task</strong> and passed on to a thread pool. The threads in the thread pool will process the requests on the connections concurrently.</p>

<h3>Code</h3>

<p><strong>a <a href="http://tutorials.jenkov.com/java-concurrency/thread-pools.html">simple thread pool implementation</a></strong></p>

<p>Pool Class:</p>

<pre><code>public class ThreadPool {

  private BlockingQueue taskQueue = null;
  private List&lt;PoolThread&gt; threads = new ArrayList&lt;PoolThread&gt;();
  private boolean isStopped = false;

  public ThreadPool(int noOfThreads, int maxNoOfTasks){
    taskQueue = new BlockingQueue(maxNoOfTasks);

    for(int i=0; i&lt;noOfThreads; i++){
      threads.add(new PoolThread(taskQueue));
    }
    for(PoolThread thread : threads){
      thread.start();
    }
  }

  public void synchronized execute(Runnable task){
    if(this.isStopped) throw
      new IllegalStateException("ThreadPool is stopped");

    this.taskQueue.enqueue(task);
  }

  public synchronized void stop(){
    this.isStopped = true;
    for(PoolThread thread : threads){
      thread.stop();
    }
  }
}
</code></pre>

<p>Thread Class:</p>

<pre><code>public class PoolThread extends Thread {

  private BlockingQueue taskQueue = null;
  private boolean       isStopped = false;

  public PoolThread(BlockingQueue queue){
    taskQueue = queue;
  }

  public void run(){
    while(!isStopped()){
      try{
        Runnable runnable = (Runnable) taskQueue.dequeue();
        runnable.run();
      } catch(Exception e){
        //log or otherwise report exception,
        //but keep pool thread alive.
      }
    }
  }

  public synchronized void stop(){
    isStopped = true;
    this.interrupt(); //break pool thread out of dequeue() call.
  }

  public synchronized void isStopped(){
    return isStopped;
  }
}
</code></pre>

<p>An explanation:</p>

<blockquote><p>The thread pool implementation consists of two parts. A ThreadPool class which is the public interface to the thread pool, and a PoolThread class which implements the threads that execute the tasks.</p>

<p>To execute a task the method ThreadPool.execute(Runnable r) is called with a Runnable implementation as parameter. The Runnable is enqueued in the blocking queue internally, waiting to be dequeued.</p>

<p>The Runnable will be dequeued by an idle PoolThread and executed. You can see this in the PoolThread.run() method. After execution the PoolThread loops and tries to dequeue a task again, until stopped.</p>

<p>To stop the ThreadPool the method ThreadPool.stop() is called. The stop called is noted internally in the isStopped member. Then each thread in the pool is stopped by calling PoolThread.stop(). Notice how the execute() method will throw an IllegalStateException if execute() is called after stop() has been called.</p>

<p>The threads will stop after finishing any task they are currently executing. Notice the this.interrupt() call in PoolThread.stop(). This makes sure that a thread blocked in a wait() call inside the taskQueue.dequeue() call breaks out of the wait() call, and leaves the dequeue() method call with an InterruptedException thrown. This exception is caught in the PoolThread.run() method, reported, and then the isStopped variable is checked. Since isStopped is now true, the PoolThread.run() will exit and the thread dies.</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] Producer Consumer Problem]]></title>
    <link href="http://okckd.github.io/blog/2014/08/08/Producer-consumer-problem/"/>
    <updated>2014-08-08T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/08/Producer-consumer-problem</id>
    <content type="html"><![CDATA[<h3>Overview</h3>

<p>Producer-consumer problem illustrates the need for <strong>synchronization</strong> in systems where <strong>many processes share a resource</strong>.</p>

<p><a href="http://cs.gmu.edu/cne/modules/ipc/aqua/producer.html">In the problem</a>, two processes share a fixed-size buffer. One process produces information and puts it in the buffer, while the other process consumes information from the buffer. These processes do not take turns accessing the buffer, they both work concurrently.</p>

<h3>Inadequate Solution</h3>

<p><img class="middle" src="http://okckd.github.io/assets/images/producer-workflow.gif"></p>

<p><img class="middle" src="http://okckd.github.io/assets/images/consumer-workflow.gif"></p>

<p><strong>The code might look like this</strong>:</p>

<pre><code>BufferSize = 3;
  count = 0;

Producer()
{
    int widget;
    WHILE (true) {                   // loop forever
      make_new(widget);              // create a new widget to put in the buffer
      IF(count==BufferSize)
           Sleep();                  // if the buffer is full, sleep
      put_item(widget);              // put the item in the buffer
      count = count + 1;             // increment count of items
      IF (count==1)
         Wakeup(Consumer);           // if the buffer was previously empty, wake
   }                                 //  the consumer
}

Consumer()
{
    int widget;
    WHILE(true) {                    // loop forever
      IF(count==0)
           Sleep();                  // if the buffer is empty, sleep
      remove_item(widget);           // take an item from the buffer
      count = count + 1;             // decrement count of items
      IF(count==N-1)
            Wakeup(Producer);        // if buffer was previously full, wake
                                     //  the producer
      Consume_item(widget);          // consume the item
    }
}
</code></pre>

<p>This <a href="http://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem#Inadequate_implementation">will cause problems</a>, because <strong>it contains a race condition</strong> that can lead to a deadlock. Or in simply words, it has the potential of <a href="http://cs.gmu.edu/cne/modules/ipc/purple/prodsem.html">losing wakeups</a>.</p>

<p>An alternative analysis is that if the programming language does not define the semantics of <strong>concurrent accesses to shared variables (in this case itemCount)</strong> without use of synchronization, then the solution is unsatisfactory for that reason, without needing to explicitly demonstrate a race condition.</p>

<p>Solutions are: <strong>semaphores or monitors</strong>.</p>

<h3>Semaphore</h3>

<pre><code>semaphore mutex = 1;
semaphore fillCount = 0;
semaphore emptyCount = BUFFER_SIZE;

procedure producer() {
    while (true) {
        item = produceItem();
        down(emptyCount);
            down(mutex);
                putItemIntoBuffer(item);
            up(mutex);
        up(fillCount);
    }
}

procedure consumer() {
    while (true) {
        down(fillCount);
            down(mutex);
                item = removeItemFromBuffer();
            up(mutex);
        up(emptyCount);
        consumeItem(item);
    }
}
</code></pre>

<h3>Monitor</h3>

<pre><code>monitor ProducerConsumer {
    int itemCount;
    condition full;
    condition empty;

    procedure add(item) {
        while (itemCount == BUFFER_SIZE) {
            wait(full);
        }

        putItemIntoBuffer(item);
        itemCount = itemCount + 1;

        if (itemCount == BUFFER_SIZE -1) {
            notify(full);
        }
    }
    procedure remove() {
        while (itemCount == 0) {
            wait(empty);
        }

        item = removeItemFromBuffer();
        itemCount = itemCount - 1;

        if (itemCount == 1) {
            notify(empty);
        }


        return item;
    }
}

procedure producer() {
    while (true) {
        item = produceItem();
        ProducerConsumer.add(item);
    }
}

procedure consumer() {
    while (true) {
        item = ProducerConsumer.remove();
        consumeItem(item);
    }
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Question] Max Sum of Non-Consecutive Elements]]></title>
    <link href="http://okckd.github.io/blog/2014/08/08/Max-sum-non-consecutive/"/>
    <updated>2014-08-08T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/08/Max-sum-non-consecutive</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://tech-queries.blogspot.sg/2009/05/max-possible-sum-of-non-consecutive.html">link</a></p>

<blockquote><p>There is an integer array consisting positive numbers only.</p>

<p>Find maximum possible sum of elements such that there are no 2 consecutive elements present in the sum.</p></blockquote>

<h3>Solution</h3>

<p>It&rsquo;s a little tricky to write the equation. Always remember the <strong>basic principle of DP</strong> is to assume that solution is found for (i -1), and then we calculate solution for input (i).</p>

<p><strong>Don&rsquo;t miss the (i-1) part</strong>.</p>

<h3>Code</h3>

<p><strong>written by me</strong></p>

<pre><code>public int maxSumNonConsec(int[] input) {
    int len = input.length;
    int[] dp = new int[len];
    dp[0] = input[0];
    dp[1] = Math.max(input[0], input[1]);
    for (int i = 2; i &lt; len; i++) {
        dp[i] = Math.max(dp[i - 1], input[i] + dp[i - 2]);
    }
    return dp[len - 1];
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Question] Decimal to Hexadecimal]]></title>
    <link href="http://okckd.github.io/blog/2014/08/08/Decimal-to-Hex/"/>
    <updated>2014-08-08T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/08/Decimal-to-Hex</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://stackoverflow.com/questions/13465098/decimal-to-hexadecimal-converter-in-java">link</a></p>

<blockquote><p>Decimal to Hexadecimal conversion.</p></blockquote>

<h3>Solution</h3>

<p>Convert binary to hex as a group of 4 bits.</p>

<p>Read code.</p>

<h3>Code</h3>

<p><strong>written by me</strong></p>

<pre><code>private final char[] hexDigits = { '0', '1', '2', '3', '4', '5', '6', '7',
        '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };
private final int flag = 0x0F;

public String decToHex(int dec) {
    char[] hex = new char[8];
    for (int i = 7; i &gt;= 0; i--) {
        int oneDigit = flag &amp; dec;
        dec &gt;&gt;= 4;
        hex[i] = hexDigits[oneDigit];
    }
    return String.valueOf(hex);
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Million Phone Numbers]]></title>
    <link href="http://okckd.github.io/blog/2014/08/07/Million-phone-numbers/"/>
    <updated>2014-08-07T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/07/Million-phone-numbers</id>
    <content type="html"><![CDATA[<h3>Question 1</h3>

<p><a href="http://www.glassdoor.com/Interview/How-would-you-store-1-million-phone-numbers-QTN_456.htm">link</a></p>

<blockquote><p>How would you store 1 million phone numbers?</p></blockquote>

<h3>Solution</h3>

<p>BitMap.</p>

<blockquote><p>The key here is that 1 million phone numbers will be within some range, likely 10 million or so. 10 million bits = 10<sup>7</sup> bits ~ 0.12 GB. Just have a bit array where the first bit being set implies that the first phone number is set (e.g., 10 000 000) and the last bit indicates the last phone number (10 999 999). If you find a number in the list, just set the appropriate bit. You now have a bit vector of size 1million bits, sorted, and to check for a particular number, you just check whether the corresponding bit is set.</p></blockquote>

<h3>Question 2</h3>

<p><a href="http://www.careercup.com/question?id=7997766">link</a></p>

<blockquote><p>How would you sort 1 million phone numbers?</p></blockquote>

<h3>Solution</h3>

<p>BitMap or radix sort, both are O(n) complexity.</p>

<p>Read more <a href="http://www.vex.net/~trebla/compsci/sorting-phone-numbers.html">here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Question] Memory-related Debugging Problem]]></title>
    <link href="http://okckd.github.io/blog/2014/08/07/Memory-related-debugging-problem/"/>
    <updated>2014-08-07T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/07/Memory-related-debugging-problem</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://stackoverflow.com/questions/4531742/debugging-a-program-that-crashes-10-times-in-different-places">link</a></p>

<blockquote><p>You are given the source to an application which is crashing during run time. After running it 10 times in a debugger, you find it never crashes in the same place.</p>

<p>What programming errors could be causing this crash? How would you test each one?</p></blockquote>

<h3>Analysis</h3>

<ol>
<li><p>code depends on timer/RNG</p></li>
<li><p>disk full, i.e. other processes may delete a different file causing more space to be available</p></li>
<li><p>memory issue, i.e. other processes allocate and/or free memory</p></li>
<li><p>a pointer points to a random location in memory that is changed by another process causing some values be &ldquo;valid&rdquo; (very rare though)</p></li>
</ol>


<p><a href="http://stackoverflow.com/a/4531769">In general</a> a situation with other process is likely.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] Distributed Network Bottleneck]]></title>
    <link href="http://okckd.github.io/blog/2014/08/07/Distributed-network-bottleneck/"/>
    <updated>2014-08-07T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/07/Distributed-network-bottleneck</id>
    <content type="html"><![CDATA[<h2>Question</h2>

<p><a href="http://www.mitbbs.com/article_t/JobHunting/32702821.html">link</a></p>

<blockquote><p>一个distributed的环境，有很多机器，现在你发现性能有问题，可能是网络带宽造成的，你怎么解决？ (你不能更换网络设备的前提下)</p></blockquote>

<h3>Answer</h3>

<ol>
<li>Identify problem</li>
</ol>


<p>首先得判定是否真的是网络造成的，就算是网络问题，哪些机器之间的网络问题？ 这个得先大概了解high level component dependency relationship，</p>

<p>看看是不是cpu memory disk都没有问题。 可以profile几个机器看看是不是 a lot of time spent waiting for network calls.</p>

<ol>
<li>Locate the faulty component</li>
</ol>


<p>判定是网络问题之后看是哪些components之间，或是某个component里面有很多网络通讯。</p>

<ol>
<li>Improvement</li>
</ol>


<p>不能更换设备的话，能不能改network topology来让critical path machine之间的带宽有改善。</p>

<p>要是不能改topology就只能改程序了。还是先identify top offender,然后就只能慢慢改了</p>

<ol>
<li>What&rsquo;s more</li>
</ol>


<p>要还有时间的话就可以聊聊问啥不能换设备，是资金问题还是用的已经是top of the line了？</p>

<p>或者是在public cloud上？</p>

<p>Answer suggested by user <strong>remus</strong>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[CC150] 9.7 Sort Large Files]]></title>
    <link href="http://okckd.github.io/blog/2014/08/07/9-4-sort-large-files/"/>
    <updated>2014-08-07T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/07/9-4-sort-large-files</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p>9.7 If you have a 2 GB file with one string per line, which sorting algorithm would you use to sort the file and why?</p>

<h3>Solution</h3>

<p><strong>External Sorting</strong> and N-way merge.</p>

<ol>
<li>Divide the file into K chunks, where X * K = 2 GB Bring each chunk into memory and sort the lines as usual using any O(n log n) algorithm Save the lines back to the file</li>
<li>Now bring the next chunk into memory and sort</li>
<li>Once we’re done, merge them one by one</li>
</ol>


<h3>Details</h3>

<p><a href="http://en.wikipedia.org/wiki/External_sorting#External_merge_sort">Wiki example</a> of sorting 900 megabytes of data using only 100 megabytes of RAM:</p>

<ol>
<li><strong>Read 100 MB of the data in main memory and sort</strong> by some conventional method, like quicksort.</li>
<li>Write the sorted data to disk.</li>
<li>Repeat steps 1 and 2 until all of the data is in sorted 100 MB chunks (there are 900MB / 100MB = 9 chunks), which now need to be merged into one single output file.</li>
<li><strong>Read the first 10 MB (= 100MB / (9 chunks + 1)) of each sorted chunk</strong> into input buffers in main memory and allocate the remaining 10 MB for an output buffer. (In practice, it might provide better performance to make the output buffer larger and the input buffers slightly smaller.)</li>
<li><strong>Perform a 9-way merge</strong> and store the result in the output buffer. Whenever the output buffer fills, write it to the final sorted file and empty it. Whenever any of the 9 input buffers empties, fill it with the next 10 MB of its associated 100 MB sorted chunk until no more data from the chunk is available. <strong>This is the key step that makes external merge sort work externally</strong> &mdash; because the merge algorithm only makes one pass sequentially through each of the chunks, each chunk does not have to be loaded completely; rather, sequential parts of the chunk can be loaded as needed.</li>
</ol>


<h3>Similar Question</h3>

<p><a href="http://www.glassdoor.com/Interview/Sort-a-million-32-bit-integers-using-only-2MB-of-RAM-QTN_120936.htm">link</a></p>

<blockquote><p>[Google] Sort a million 32 bit integers using only 2MB of RAM.</p></blockquote>

<p>1 million integers = 4MB which is > 2MB RAM.</p>

<p>Solution: external sort &ndash; divide and conquer</p>

<ol>
<li>read half the list into 2MB ram and sort using quicksort (quicksort uses logn space &ndash; however 0.5m integers is less than 2MB (2000kb v 2048kb) so this should be okay).</li>
<li>write sorted data to disk</li>
<li>repeat for next chunk</li>
<li>merging results: we need an output buffer. lets say this is 1MB. then we read 512KB from each of your chunks into input buffers. we then perform a 2-way merge of the data. when an input buffer becomes empty we can pull in the remainder of the chunk.</li>
<li>when the output buffer is full we write this to disk.</li>
<li>when the process completes we are left with 2x 1MB files sorted in the correct order.</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Postorder Successor in Binary Tree]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/Postorder-successor-Binary-Tree/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/Postorder-successor-Binary-Tree</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://www.careercup.com/question?id=5173972006076416">link</a></p>

<blockquote><p>Write an algorithm to find the ‘next’ post-order successor of a given node in a binary tree and binary search tree.</p>

<ol>
<li>where each node has a link to its parent.</li>
<li>without parent pointer</li>
</ol>


<p>Implement 2 versions of the algorithm: 1.) binary tree 2.) BST</p></blockquote>

<h3>Solution</h3>

<p>In postorder, any node below current node shall be &lsquo;predecessor&rsquo; of current node. Thus we only care about current node&rsquo;s parent.</p>

<p>Suggested by a user:</p>

<pre><code>1) parent pointer is given. 
- go to the parent of the current node. 
- if current node is the right child of its parent =&gt; print parent. 
- else return leftmost node of the right sub-tree of parent. 

2) parent pointer is not given. 
- traverse the tree and find the parent of the current node 
- do the same as method (1). 
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] Networks and TCP/IP]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/Networks-and-TCP-IP/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/Networks-and-TCP-IP</id>
    <content type="html"><![CDATA[<h2>Overview</h2>

<p><strong><a href="http://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite</a></strong> is a networking model and communications protocols used by the Internet. It is commonly known as <strong>TCP/IP</strong>.</p>

<p>Four abstraction layers:</p>

<ol>
<li>Application layer</li>
<li>Transport layer</li>
<li>Internet layer</li>
<li>Link layer</li>
</ol>


<p><img class="middle" src="http://okckd.github.io/assets/images/network-layers-connected.png"></p>

<p>The protocols are maintained by the <strong>Internet Engineering Task Force</strong> (IETF).</p>

<h3>A summary of four-layer model</h3>

<ol>
<li>Application: authentication, compression, and end user services</li>
<li>Transport: handles the flow of data between systems and provides access to the network for applications via the BSD socket library</li>
<li>Network: packet routing</li>
<li>Link: Kernel OS/device driver interface to the network interface on the computer.</li>
</ol>


<p><a href="http://searchnetworking.techtarget.com/news/851291/TCP-Internet-Protocol-and-OSI">source</a></p>

<h3>More details</h3>

<p><strong>The Application layer</strong>:</p>

<ol>
<li>where applications create user data and communicate with other applications on another host (make use of Transport Layer to provide reliable or unreliable pipes to other processes).</li>
<li>different application architecture, such as the client-server model and peer-to-peer.</li>
<li>SMTP, FTP, SSH, HTTP all operate above this layer.</li>
<li>processes are addressed via ports.</li>
</ol>


<p><img class="middle" src="http://okckd.github.io/assets/images/network-ports.gif"></p>

<blockquote><p>Well-known official port numbers are in the range of 0 &ndash; 255. Port 256 &ndash; 1023 are reserved for other well-known services. 1024 &ndash; 65535 are neither in-use nor reserved. They are used when TCP/IP automatically assigns port numbers to client programs.</p></blockquote>

<p><strong>The Transport Layer</strong>:</p>

<ol>
<li>performs host-to-host communications.</li>
<li>&ldquo;UDP&rdquo; provides unreliable datagram service.</li>
<li>&ldquo;<strong>Transmission Control Protocol</strong>&rdquo; provides flow-control, connection establishment, and reliable transmission of data.</li>
</ol>


<p><strong>The Internet layer</strong>:</p>

<ol>
<li>exchange datagrams across network boundaries.</li>
<li>establishes internetworking thus establishes the Internet.</li>
<li>&ldquo;<strong>Internet Protocol</strong>&rdquo;, defines IP addresses and the routing structures used for the TCP/IP protocol suite.</li>
<li>routing: transport datagrams to the next IP router that has the connectivity to a network closer to the final data destination.</li>
</ol>


<p><strong>The Link layer</strong>:</p>

<ol>
<li>defines the networking methods within local network link without intervening routers.</li>
<li>describe local network topology and the interfaces needed to effect transmission of Internet layer datagrams to next-neighbor hosts.</li>
</ol>


<h3>Difference from OSI</h3>

<p>The Internet protocol suite was in use <strong>before the OSI model</strong>, and is well established worldwide.</p>

<p><a href="http://electronicdesign.com/what-s-difference-between/what-s-difference-between-osi-seven-layer-network-model-and-tcpip">The OSI model</a>, however, is a proven concept that is used in all other data communications protocols. It will continue to be used as a guideline for all other communications applications.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Leetcode] Leetcode Second Round 2]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/Leetcode-second-two/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/Leetcode-second-two</id>
    <content type="html"><![CDATA[<h3>2.2 questionlist</h3>

<ol>
<li>Integer to Roman</li>
<li>Surrounded Regions &ndash; minimize stack usage</li>
<li>Jump Game II</li>
</ol>


<h3>Question List</h3>

<ol>
<li>Longest Palindromic Substring</li>
<li>Rotate List</li>
<li>Remove Duplicates from Sorted Array</li>
<li>Validate Binary Search Tree &ndash; use intervals</li>
<li>Gray Code</li>
<li>Combination Sum II</li>
<li>Add Binary</li>
<li>Merge Intervals</li>
<li>Scramble String</li>
<li>Remove Duplicates from Sorted Array II</li>
<li>Generate Parentheses</li>
<li>Permutation Sequence</li>
<li>Substring with Concatenation of All Words</li>
<li>String to Integer (atoi)</li>
</ol>


<h3>Difficult</h3>

<ol>
<li>Gas Station</li>
<li>Reverse Words in a String</li>
<li>Word Search</li>
<li>Container With Most Water</li>
<li>First Missing Positive &ndash; note there&rsquo;s 1 special case</li>
<li>Sort List</li>
<li>Anagrams</li>
<li>Merge k Sorted Lists &ndash; very difficult</li>
<li>Permutations II &ndash; use different DS for flagging elements</li>
<li>Palindrome Partitioning II</li>
<li>Word Ladder</li>
<li>Largest Rectangle in Histogram</li>
<li>Minimum Window Substring &ndash; difficult</li>
<li>Longest Valid Parentheses &ndash; difficult</li>
<li>Median of Two Sorted Arrays &ndash; difficult</li>
<li>Regular Expression Matching</li>
<li>Wildcard Matching</li>
</ol>


<h3>Special</h3>

<ol>
<li><p>water, rain and histogram etc.</p></li>
<li><p>word and string-related</p></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] HTTP Headers]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/HTTP-headers/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/HTTP-headers</id>
    <content type="html"><![CDATA[<h2>Overview</h2>

<p><strong>HTTP is an Application Layer protocol</strong> which stands for &ldquo;Hypertext Transfer Protocol&rdquo;. The entire World Wide Web uses it.</p>

<p>There&rsquo;re <strong><a href="http://www.differencebetween.net/technology/internet/difference-between-tcp-and-http/">a series of sessions</a></strong> in HTTP where client sends a request and server sends a reply message back to client including the request, an error message, or another piece of information.</p>

<p><a href="http://code.tutsplus.com/tutorials/http-headers-for-dummies--net-8039">HTTP headers</a> are the core part of these HTTP requests and responses, and they carry information about the client browser, the requested page, the server and more.</p>

<h3>Example HTTP request</h3>

<pre><code>GET /tutorials/other/top-20-mysql-best-practices/ HTTP/1.1
Host: net.tutsplus.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Cookie: PHPSESSID=r2t5uvjq435r4q7ib3vtdjq120
Pragma: no-cache
Cache-Control: no-cache
</code></pre>

<h3>Example HTTP response</h3>

<pre><code>HTTP/1.x 200 OK
Transfer-Encoding: chunked
Date: Sat, 28 Nov 2009 04:36:25 GMT
Server: LiteSpeed
Connection: close
X-Powered-By: W3 Total Cache/0.8
Pragma: public
Expires: Sat, 28 Nov 2009 05:36:25 GMT
Etag: "pub1259380237;gz"
Cache-Control: max-age=3600, public
Content-Type: text/html; charset=UTF-8
Last-Modified: Sat, 28 Nov 2009 03:50:37 GMT
X-Pingback: http://net.tutsplus.com/xmlrpc.php
Content-Encoding: gzip
Vary: Accept-Encoding, Cookie, User-Agent

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;Top 20+ MySQL Best Practices - Nettuts+&lt;/title&gt;
&lt;!-- ... rest of the html ... --&gt;
</code></pre>

<p>These HTTP requests are also sent and received for other things, such as images, CSS files, JavaScript files etc. That is why browser may send 40 or more HTTP requests for 1 article page.</p>

<h3>Request Methods</h3>

<p>The three most commonly used request methods are: GET, POST and HEAD.</p>

<h4>GET: Retrieve a Document</h4>

<p>Get an article site:</p>

<pre><code>GET /tutorials/other/top-20-mysql-best-practices/ HTTP/1.1
</code></pre>

<p>Submit a form information:</p>

<pre><code>GET /foo.php?first_name=John&amp;last_name=Doe&amp;action=Submit HTTP/1.1
</code></pre>

<p>Each input is added in the <strong>query string</strong>.</p>

<h4>POST: Send Data to the Server</h4>

<p>Even though you can send data to the server using GET and the query string, <strong>in many cases POST will be preferable</strong>. Sending large amounts of data using GET is not practical and has limitations.</p>

<pre><code>POST /foo.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Referer: http://localhost/test.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 43

first_name=John&amp;last_name=Doe&amp;action=Submit
</code></pre>

<p>The header contains no query string no more. The last line (data) is the query string.</p>

<h4>HEAD: Retrieve Header Information</h4>

<p>HEAD is identical to GET, except the server does not return the content in the HTTP response. It&rsquo;s faster than GET.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Connect Nodes and Avoid Intersect]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/Connect-nodes-avoid-intersect/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/Connect-nodes-avoid-intersect</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://www.careercup.com/question?id=5138832865361920">link</a></p>

<blockquote><p>Draw a graph as a graph. Assume there is graphics library to draw lines and all. Just tell how will you order the vertices such that the edges don&rsquo;t intersect and they seem ordered.</p></blockquote>

<h3>Solution</h3>

<p>There&rsquo;s no clear solution. Someone suggest the following:</p>

<ol>
<li>printing topological sort result (refer to post &lsquo;Topology Sort&rsquo;)</li>
<li>edges should not intersect, finding if a graph is planar</li>
</ol>


<p>There&rsquo;s various <a href="http://en.wikipedia.org/wiki/Planarity_testing">Planarity Testing Algorithms</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Ambiguous File Matching]]></title>
    <link href="http://okckd.github.io/blog/2014/08/06/Ambiguous-File-Matching/"/>
    <updated>2014-08-06T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/06/Ambiguous-File-Matching</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://www.careercup.com/question?id=5678301561487360">link</a></p>

<blockquote><p>Given 10 files (text files) each of size of 900 Mb.</p>

<p>Given another file named &ldquo;hello&rdquo;. match the contents of this file with other 10 file and return the file whose contents closely match with the contents of file &ldquo;hello&rdquo;.</p></blockquote>

<h3>Solution</h3>

<p>The solution given on the site is not adequate, but I have to choose one that make a little sense.</p>

<blockquote><p>Score each file&rsquo;s contents on several parameters:</p>

<ol>
<li>no. of words</li>
<li>no. of letters</li>
<li>no. of spaces</li>
<li>count of each of the letters</li>
<li>count of each words</li>
</ol>


<p>Give weightage to each of the properties and arrive at a number (score). The closest of the scores is the answer.</p></blockquote>

<p>I think maybe can use <a href="http://en.wikipedia.org/wiki/Bloom_filter#Counting_filters">Counting Bloom Filter</a>, although bloom filter does not record word sequences.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Write a Random Number Generator]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/Write-a-RNG/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/Write-a-RNG</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://www.careercup.com/question?id=5173972006076416">link</a></p>

<h3>Solution</h3>

<p>Basically, the formula is as follows:</p>

<blockquote><p>number = (previous_number * constant + other_constant) mod third_constant</p></blockquote>

<p>The three constants are carefully selected, and a typical choice is:</p>

<blockquote><p>number = (previous_number * 214013 + 2531011) mod 2<sup>15</sup></p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] Application Server vs. Web Server]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/Web-server-application-server/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/Web-server-application-server</id>
    <content type="html"><![CDATA[<h2>Overview</h2>

<p>A Web server <strong>exclusively handles HTTP requests</strong>, whereas an application server <strong>serves business logic</strong> to application programs through any number of protocols.</p>

<h3>Web server</h3>

<p>A <a href="http://www.javaworld.com/article/2077354/learn-java/app-server-web-server-what-s-the-difference.html">Web server</a> <strong>handles the HTTP protocol</strong>. When the Web server receives an HTTP request, it responds with an HTTP response, such as sending back an HTML page.</p>

<p>To process a request, a Web server may <strong>respond with a static HTML page</strong>, or delegate the <strong>dynamic response</strong> such as CGI scripts, JSPs (JavaServer Pages), servlets, ASPs (Active Server Pages), server-side JavaScripts, or some other server-side technology.</p>

<h3>Application server</h3>

<p>An <a href="http://www.javaworld.com/article/2077354/learn-java/app-server-web-server-what-s-the-difference.html">Application server</a> <strong>exposes business logic to client applications</strong> through various protocols, possibly including HTTP. The clients can include GUIs (graphical user interface) running on a PC, a Web server, or even other application servers.</p>

<p>In most cases, the server exposes this business logic through a component API, such as <strong>the EJB (Enterprise JavaBean) component model</strong> found on J2EE (Java 2 Platform, Enterprise Edition) application servers.</p>

<p>Moreover, the application server manages its own resources. Such gate-keeping duties include security, transaction processing, resource pooling, and messaging.</p>

<p>There&rsquo;s <a href="http://www.javaworld.com/article/2077354/learn-java/app-server-web-server-what-s-the-difference.html">a nice example</a> as well.</p>

<h3>Another explanation</h3>

<p>Web server on the left.</p>

<table>
    <tbody><tr id="row1" title="Application Server vs Web Server comparison - What is it?"><td class="acol bg-color bg-img font-color">What is it?</td>                <td id="valtd1_1" class="vcol bg-color bg-img font-color">A server that exposes business logic to client applications through various protocols including HTTP.</td>
                <td id="valtd1_2" class="vcol bg-color bg-img font-color">A server that handles HTTP protocol.</td>
                </tr><tr id="row2" title="Application Server vs Web Server comparison - Job"><td class="acol bg-color bg-img font-color">Job</td>                <td id="valtd2_1" class="vcol bg-color bg-img font-color">Application server is used to serve web based applications and enterprise based applications(i.e servlets, jsps and ejbs&#8230;). Application servers may contain a web server internally.</td>
                <td id="valtd2_2" class="vcol bg-color bg-img font-color">Web server is used to serve web based applications.(i.e servlets and jsps)</td>
                </tr><tr id="row3" title="Application Server vs Web Server comparison - Functions"><td class="acol bg-color bg-img font-color">Functions</td>                <td id="valtd3_1" class="vcol bg-color bg-img font-color">To deliver various applications to another device, it allows everyone in the network to run software off of the same machine.</td>
                <td id="valtd3_2" class="vcol bg-color bg-img font-color">Keeping HTML, PHP, ASP etc  files available for the web browsers to view when a user accesses the site on the web, handles HTTP requests from clients.</td>
                </tr><tr id="row4" title="Application Server vs Web Server comparison - Supports"><td class="acol bg-color bg-img font-color">Supports</td>                <td id="valtd4_1" class="vcol bg-color bg-img font-color">distributed transaction and EJB&#8217;s</td>
                <td id="valtd4_2" class="vcol bg-color bg-img font-color">Servlets and JSP</td>
                </tr><tr class="comparisonRow diff lastRow" id="row5" title="Application Server vs Web Server comparison - Resource utilization"><td class="acol bg-color bg-img font-color">Resource utilization</td>                <td id="valtd5_1" class="vcol bg-color bg-img font-color">High</td>
    <td id="valtd5_2" class="vcol bg-color bg-img font-color">Low</td>
</tr></tbody></table>


<br />


<h4>Miscellaneous</h4>

<p>For <a href="http://www.geekinterview.com/question_details/17043">J2EE</a>, Web server is used only for <strong>Jsp and Servlets</strong> and static functionality. It doesn&rsquo;t support <strong>EJB and JMS and JAAS</strong>.</p>

<p>Application server is basically:</p>

<blockquote><p>AppServer = WebServer + EJB container.</p></blockquote>

<p><strong>Tomcat is web container</strong> where as Apache is web server.</p>

<p>An Application Server may include a Web Server inside it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] Upcasting, Downcasting and Object Slicing]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/Upcasting-and-Object-Slicing/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/Upcasting-and-Object-Slicing</id>
    <content type="html"><![CDATA[<h3>Upcasting and Downcasting</h3>

<p>Java permits an object of a <strong>subclass type to be treated as an object of any superclass type</strong>. This is <a href="http://forum.codecall.net/topic/50451-upcasting-downcasting/">called upcasting</a>. Upcasting is done automatically, while downcasting must be manually done.</p>

<p><a href="http://forum.codecall.net/topic/50451-upcasting-downcasting/">Example</a>:</p>

<p><img class="middle" src="http://okckd.github.io/assets/images/java-upcasting-downcasting.jpg"></p>

<pre><code>Cat c1 = new Cat();
Animal a = c1; //automatic upcasting to Animal
Cat c2 = (Cat) a; //manual downcasting back to a Cat
</code></pre>

<p>Upcasting is always typesafe but can cause the so called <a href="http://forums.codeguru.com/showthread.php?321676-What-are-upcasting-and-downcasting-dangers">&ldquo;slicing&rdquo; problem</a>.</p>

<h3>Object Slicing</h3>

<p><a href="https://www.java.net/also-in-java/object-slicing-and-component-design-java">Object slicing</a> is defined as the conversion of an object into something with less information (typically a superclass)</p>

<h3>More detail</h3>

<p>If you upcast an object, it will <strong>lose all it&rsquo;s properties</strong>, which were inherited. For example, if you cast a Cat to an Animal, it will lose properties inherited from Mammal and Cat. Note, that <strong>data will not be lost, you just can&rsquo;t use it</strong>, until you downcast the object to the right level.</p>

<h3>Example</h3>

<pre><code>class Base {
    void doSomething() {
        System.out.println("Base");
    }
}

class Derived extends Base {
    void doSomething() {
        System.out.println("Derived");
    }
}

public class JavaUpcasting {
    public static void main(String[] args) {
        Base instance = new Derived();
        instance.doSomething();
    }
}
</code></pre>

<p>This will output &ldquo;Derived&rdquo;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Google] Replace Question Mark With Number]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/Replace-Question-Mark-WIth-Number/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/Replace-Question-Mark-WIth-Number</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://www.careercup.com/question?id=5192571630387200">link</a></p>

<blockquote><p>Given a string (for example: &ldquo;a?bc?def?g&rdquo;), write a program to generate all the possible strings by replacing ? with 0 and 1.</p>

<p>Input : a?b?c?</p>

<p>Output: a0b0c0, a0b0c1, a0b1c0, a0b1c1, a1b0c0, a1b0c1, a1b1c0, a1b1c1.</p></blockquote>

<h3>Solution</h3>

<p>DFS search, but do not forget to set &ldquo;<strong>letters[pos] = &lsquo;?&rsquo;;</strong>&rdquo; at the end. I made this error once.</p>

<h3>Code</h3>

<pre><code>public List&lt;String&gt; solution(String str) {
    List&lt;String&gt; result = new ArrayList&lt;String&gt;();
    helper(result, str.toCharArray(), 0);
    return result;
}

private void helper(List&lt;String&gt; result, char[] letters, int pos) {
    if (pos == letters.length) {
        result.add(String.valueOf(letters));
        return;
    } else if (letters[pos] != '?') {
        helper(result, letters, pos + 1);
        return;
    }
    for (char i = '0'; i &lt;= '1'; i++) {
        // put char i in letters[] to replace the '?'
        letters[pos] = i;
        helper(result, letters, pos + 1);
        letters[pos] = '?';
    }
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] MapReduce Intro]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/MapReduce-Intro/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/MapReduce-Intro</id>
    <content type="html"><![CDATA[<h3>An Overview</h3>

<p><strong><a href="http://searchcloudcomputing.techtarget.com/definition/MapReduce">MapReduce</a> is a software framework</strong>, or a <strong><a href="http://www.theserverside.com/news/1321219/Why-Should-You-Care-About-MapReduce">distributed programming model</a></strong> intended for processing massive amounts of data in large clusters.</p>

<ol>
<li><p><strong>Map</strong>, a function that parcels out work to different nodes in the distributed cluster.</p></li>
<li><p><strong>Reduce</strong>, another function that collates the work and resolves the results into a single value.</p></li>
</ol>


<h3>More Info</h3>

<p><strong>MapReduce isn&rsquo;t intended to replace relational databases</strong>: it&rsquo;s intended to provide a lightweight way of programming things so that they can run fast by running in parallel on a lot of machines. Google uses MapReduce for <strong>indexing every Web page</strong> they crawl.</p>

<p>MapReduce framework is <strong>fault-tolerant</strong> because each node in the cluster is expected to report back periodically with completed work and status updates. If a node remains silent for longer than the expected interval, a master node makes note and re-assigns the work to other nodes.</p>

<p><strong>From a Senior Software Engineer at Google</strong>:</p>

<blockquote><p>The key to how MapReduce works is to take input as, conceptually, a list of records. The records are split among the different computers in the cluster by Map. The result of the Map computation is a list of key/value pairs. Reduce then takes each set of values that has the same key and combines them into a single value. So Map takes a set of data chunks and produces key/value pairs and Reduce merges things, so that instead of a set of key/value pair sets, you get one result. You can&rsquo;t tell whether the job was split into 100 pieces or 2 pieces&hellip;</p></blockquote>

<h3>Why MapReduce</h3>

<p>MapReduce is important because it allows ordinary developers to use MapReduce library routines to create parallel programs without having to worry about programming for intra-cluster communication, task monitoring or failure handling.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Design] MapReduce Common Friends Example]]></title>
    <link href="http://okckd.github.io/blog/2014/08/05/MapReduce-Common-Friends/"/>
    <updated>2014-08-05T00:00:00+08:00</updated>
    <id>http://okckd.github.io/blog/2014/08/05/MapReduce-Common-Friends</id>
    <content type="html"><![CDATA[<h3>Question</h3>

<p><a href="http://stackoverflow.com/a/12375878">link</a></p>

<blockquote><p>Facebook&rsquo;s &ldquo;You and Joe have 230 friends in common&rdquo; feature. Sure you could use a decent caching strategy, but for now, use MapReduce.</p></blockquote>

<h3>Analysis</h3>

<p>This list doesn&rsquo;t change frequently so it&rsquo;d be wasteful to recalculate it every time. We&rsquo;re going to use mapreduce to calculate everyone&rsquo;s common friends once a day and store those results.</p>

<p>Note that friends are <strong>bi-directional</strong>. If I&rsquo;m your friend, you&rsquo;re mine. (follow-up: how to do it for follower system?)</p>

<h4>Input</h4>

<p>Assume the friends are stored as Person->[List of Friends], our friends list is then:</p>

<pre><code>A -&gt; B C D
B -&gt; A C D E
C -&gt; A B D E
D -&gt; A B C E
E -&gt; B C D
</code></pre>

<h4>Map</h4>

<p>The mapper will output a key-value pair. The key will be a friend along with the person. The value will be the list of friends. The key will be sorted so that the friends are in order, causing all pairs of friends to go to the same reducer.</p>

<p>For map(A &ndash;> B C D) :</p>

<pre><code>(A B) -&gt; B C D
(A C) -&gt; B C D
(A D) -&gt; B C D
</code></pre>

<p>For map(B &ndash;> A C D E) : (Note that A comes before B in the key)</p>

<pre><code>(A B) -&gt; A C D E
(B C) -&gt; A C D E
(B D) -&gt; A C D E
(B E) -&gt; A C D E
</code></pre>

<p>For map(C &ndash;> A B D E) :</p>

<pre><code>(A C) -&gt; A B D E
(B C) -&gt; A B D E
(C D) -&gt; A B D E
(C E) -&gt; A B D E
</code></pre>

<p>For map(D &ndash;> A B C E) :</p>

<pre><code>(A D) -&gt; A B C E
(B D) -&gt; A B C E
(C D) -&gt; A B C E
(D E) -&gt; A B C E
</code></pre>

<p>And finally for map(E &ndash;> B C D):</p>

<pre><code>(B E) -&gt; B C D
(C E) -&gt; B C D
(D E) -&gt; B C D
</code></pre>

<p>Before we send these key-value pairs to the reducers, we group them by their keys and get:</p>

<pre><code>(A B) -&gt; (A C D E) (B C D)
(A C) -&gt; (A B D E) (B C D)
(A D) -&gt; (A B C E) (B C D)
(B C) -&gt; (A B D E) (A C D E)
(B D) -&gt; (A B C E) (A C D E)
(B E) -&gt; (A C D E) (B C D)
(C D) -&gt; (A B C E) (A B D E)
(C E) -&gt; (A B D E) (B C D)
(D E) -&gt; (A B C E) (B C D)
</code></pre>

<p>Each line will be passed as an argument to a reducer.</p>

<h4>Reduce</h4>

<p>The reduce function will simply intersect the lists of values and output the same key with the result of the intersection. After reduction:</p>

<pre><code>(A B) -&gt; (C D)
(A C) -&gt; (B D)
(A D) -&gt; (B C)
(B C) -&gt; (A D E)
(B D) -&gt; (A C E)
(B E) -&gt; (C D)
(C D) -&gt; (A B E)
(C E) -&gt; (B D)
(D E) -&gt; (B C)
</code></pre>

<h4>Result</h4>

<p>Now when D visits B&rsquo;s profile, we can quickly look up (B D) and see that they have three friends in common, (A C E).</p>
]]></content>
  </entry>
  
</feed>
