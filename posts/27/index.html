
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Shuatiblog.com</title>
  <meta name="author" content="CodeMonkey">

  
  <meta name="description" content="Question Explain how you would design a chat server. In particular, provide details about the various back end components, classes, and methods. What &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.shuatiblog.com/posts/27/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Shuatiblog.com" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-52495723-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.shuatiblog.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">
        <span class="blue_light">
            Shuatiblog.com
        </span>
       
    </a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/24/design-online-chat-server-1/">[CC150v5] 8.7 Design Online Chat Server (1)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-24T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/24/design-online-chat-server-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<blockquote><p>Explain how you would design a chat server. In particular, provide details about the various back end components, classes, and methods.</p>

<p>What would be the hardest problems to solve?</p></blockquote>

<h3>Solution</h3>

<p>First, decide the objects and methods. Here we&rsquo;ll focus on the core user management and conversation aspects.</p>

<h4>Class</h4>

<ol>
<li>UserMgmt (business logic)</li>
<li>User (includes basic info, UserStatus, a map of conversation, a map of requests)</li>
<li>UserStatus (on/offline, status message)</li>
<li>Conversation Abstract Class (a list of user and a list of messages)

<ol>
<li>PrivateChat (private conversation)</li>
<li>GroupChat</li>
</ol>
</li>
<li>Message (a string and a date/time)</li>
<li>Request (add request and delete request, involves 2 Users)</li>
</ol>


<h4>Functions</h4>

<ol>
<li>Sign in and log off (update availability)</li>
<li>update status message</li>
<li>add/delete request</li>
<li>send/accept/reject a request</li>
<li>create a conversation (group or private)</li>
<li>add a new message (group or private)</li>
</ol>


<h3>Code</h3>

<p>The most important classes is User and UserMgmt. The others are simply data containers.</p>

<p>UserManager.java</p>

<pre><code>public class UserManager {
    private static UserManager instance;
    private HashMap&lt;Integer, User&gt; usersById = new HashMap&lt;Integer, User&gt;();
    private HashMap&lt;String, User&gt; usersByAccountName = new HashMap&lt;String, User&gt;();
    private HashMap&lt;Integer, User&gt; onlineUsers = new HashMap&lt;Integer, User&gt;();

    public static UserManager getInstance() {
        if (instance == null) {
            instance = new UserManager();
        }
        return instance;
    }

    public void addUser(User fromUser, String toAccountName) {
        User toUser = usersByAccountName.get(toAccountName);
        AddRequest req = new AddRequest(fromUser, toUser, new Date());
        toUser.receivedAddRequest(req);
        fromUser.sentAddRequest(req);
    }

    public void approveAddRequest(AddRequest req) {
        req.status = RequestStatus.Accepted;
        User from = req.getFromUser();
        User to = req.getToUser();
        from.addContact(to);
        to.addContact(from);
    }

    public void rejectAddRequest(AddRequest req) {
        req.status = RequestStatus.Rejected;
        User from = req.getFromUser();
        User to = req.getToUser();
        from.removeAddRequest(req);
        to.removeAddRequest(req);       
    }

    public void userSignedOn(String accountName) {
        User user = usersByAccountName.get(accountName);
        if (user != null) {
            user.setStatus(new UserStatus(UserStatusType.Available, ""));           
            onlineUsers.put(user.getId(), user);
        }
    }

    public void userSignedOff(String accountName) {
        User user = usersByAccountName.get(accountName);
        if (user != null) {
            user.setStatus(new UserStatus(UserStatusType.Offline, ""));
            onlineUsers.remove(user.getId());
        }
    }   
}
</code></pre>

<p>User.java</p>

<p>Property:</p>

<ol>
<li>id and name</li>
<li>a map of conversations</li>
<li>a map of sent request</li>
<li>a map of received request</li>
<li>a map of friends list</li>
</ol>


<p>Methods:</p>

<ol>
<li>sendMessageToUser(User)</li>
<li>addContact(User)</li>
<li>receivedAddRequest(Request)</li>
<li>sentAddRequest(Request)</li>
<li>removeAddRequest(Request)</li>
<li>addConversation(Conversation)</li>
</ol>


<p>Note that all user actions are controlled by the UserManager Class. For example, when adding a friend:</p>

<ol>
<li>User A clicks &ldquo;add user&rdquo; on the client.</li>
<li>User A calls requestAddUser (User B).</li>
<li>This method calls UserManager.addUser(User a, userBid).</li>
<li>UserManager calls both User A.sentAddRequest() and User B.receivedAddRequest().</li>
</ol>


<p>Code:</p>

<pre><code>public class User {
    private int id;
    private UserStatus status = null;
    private HashMap&lt;Integer, PrivateChat&gt; privateChats = new HashMap&lt;Integer, PrivateChat&gt;();
    private ArrayList&lt;GroupChat&gt; groupChats = new ArrayList&lt;GroupChat&gt;();
    private HashMap&lt;Integer, AddRequest&gt; receivedAddRequests = new HashMap&lt;Integer, AddRequest&gt;();
    private HashMap&lt;Integer, AddRequest&gt; sentAddRequests = new HashMap&lt;Integer, AddRequest&gt;();

    private HashMap&lt;Integer, User&gt; contacts = new HashMap&lt;Integer, User&gt;();
    private String accountName;
    private String fullName;

    public User(int id, String accountName, String fullName) {
        this.accountName = accountName;
        this.fullName = fullName;
        this.id = id;
    }

    public boolean sendMessageToUser(User toUser, String content) {
        PrivateChat chat = privateChats.get(toUser.getId());
        if (chat == null) {
            chat = new PrivateChat(this, toUser);
            privateChats.put(toUser.getId(), chat);
        }
        Message message = new Message(content, new Date());
        return chat.addMessage(message);
    }

    public boolean sendMessageToGroupChat(int groupId, String content) {
        GroupChat chat = groupChats.get(groupId);
        if (chat != null) {
            Message message = new Message(content, new Date());
            return chat.addMessage(message);
        }
        return false;
    }

    public void setStatus(UserStatus status) {
        this.status = status;
    }

    public UserStatus getStatus() {
        return status;
    }

    public boolean addContact(User user) {
        if (contacts.containsKey(user.getId())) {
            return false;
        } else {
            contacts.put(user.getId(), user);
            return true;
        }
    }

    public void receivedAddRequest(AddRequest req) {
        int senderId = req.getFromUser().getId();
        if (!receivedAddRequests.containsKey(senderId)) {
            receivedAddRequests.put(senderId, req);
        }       
    }

    public void sentAddRequest(AddRequest req) {
        int receiverId = req.getFromUser().getId();
        if (!sentAddRequests.containsKey(receiverId)) {
            sentAddRequests.put(receiverId, req);
        }       
    }

    public void removeAddRequest(AddRequest req) {
        if (req.getToUser() == this) {
            receivedAddRequests.remove(req);
        } else if (req.getFromUser() == this) {
            sentAddRequests.remove(req);
        }
    }

    public void requestAddUser(String accountName) {
        UserManager.getInstance().addUser(this, accountName);
    }

    public void addConversation(PrivateChat conversation) {
        User otherUser = conversation.getOtherParticipant(this);
        privateChats.put(otherUser.getId(), conversation);
    }

    public void addConversation(GroupChat conversation) {
        groupChats.add(conversation);
    }   

    public int getId() {
        return id;
    }

    public String getAccountName() {
        return accountName;
    }

    public String getFullName() {
        return fullName;
    }
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/23/stack-and-heap/">[Design] Stack and Heap</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-23T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/23/stack-and-heap/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Overview</h3>

<p>Value types are created on the stack, and reference types are created on the heap.</p>

<p><strong>Both are stored in computer RAM</strong>.</p>

<p><strong>Each thread gets a stack</strong>, while there&rsquo;s typically only one heap for the application.</p>

<h4>Stack</h4>

<p><a href="http://stackoverflow.com/a/80113">When a function</a> is called, a block is reserved <strong>on the top of the stack</strong> for local variables and some bookkeeping data in a LIFO order. Freeing a block from the stack is nothing more than adjusting one pointer.</p>

<h4>Heap</h4>

<p>Unlike the stack, there&rsquo;s no enforced pattern to the allocation and deallocation of blocks from the heap; you can allocate a block at any time and free it at any time. This makes it much more complex to keep track of which parts of the heap are allocated or free at any given time; there are many custom heap allocators available to tune heap performance for different usage patterns.</p>

<h3>Q &amp; A</h3>

<h4>What is their scope?</h4>

<p>The stack is attached to a thread, so <strong>when the thread exits</strong> the stack is reclaimed.</p>

<p>The heap is typically allocated at application startup by the runtime, and is reclaimed <strong>when the application (technically process) exits</strong>.</p>

<p>Thread and process &ndash; what&rsquo;s the difference? Read <strong>[Design] Process VS. Thread</strong>.</p>

<h4>What determines the size of each of them?</h4>

<p>The size of the stack is set when a thread is created.</p>

<p>The size of the heap is set on application startup, but can grow as space is needed (the allocator requests more memory from the operating system).</p>

<h4>What makes one faster?</h4>

<p><strong>The stack is faster</strong> because the access pattern makes it trivial to allocate and deallocate memory from it, while the heap has much more complex bookkeeping involved in an allocation or free.</p>

<p>Each byte in the stack tends to be reused very frequently which means it tends to be mapped to the processor&rsquo;s cache, making it very fast.</p>

<p>Another performance hit for the heap is that the heap, being mostly a global resource, typically has to be multi-threading safe, i.e. each allocation and deallocation needs to be (typically) synchronized.</p>

<p><img class="middle" src="/assets/images/stack-and-heap.png"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/23/Web-hosting-shared-and-vps/">[Design] Shared Hosting vs. VPS Hosting</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-23T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/23/Web-hosting-shared-and-vps/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Shared hosting</h3>

<p><a href="https://kb.greengeeks.com/3072/shared-hosting-vs-vps-hosting/">Shared hosting</a> is like living in an apartment where you share a common space with your neighbors. You cannot customize anything but you share maintenance cost and responsibility with your neighbors.</p>

<ol>
<li>Economical</li>
<li>Technical maintenance of the server is not required</li>
<li>Limited number of resources</li>
<li>Your website performance may be affected by other websites hosted on the shared server</li>
<li>Possible long term problems with scalability and backup</li>
<li>Possible security issues for sharing a common server</li>
</ol>


<h3>Virtual Private Server</h3>

<p>Virtual Private Server (VPS) Hosting is like living in a simplex or half-plex where you can customize everything to your own tastes. However, you still need to maintain your own area. Companies that deal with resource-heavy applications and secured data most often use VPS.</p>

<ol>
<li>Larger space and bandwidth</li>
<li>Can configure anything</li>
<li>Run your own batch files to create multiple services inside the server using shell access</li>
<li>Easy scalability and backup</li>
<li>You need a dedicated system administrator</li>
<li>Costly</li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/23/BST-over-hashmap/">[Design] Merits of BST Over HashTables</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-23T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/23/BST-over-hashmap/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<p><a href="http://stackoverflow.com/questions/4128546/advantages-of-binary-search-trees-over-hash-tables">What are the advantages</a> of binary search trees over hash tables?</p>

<h3>Answer</h3>

<ol>
<li><p><strong>More memory-efficient</strong>. (They do not reserve more memory than they need to)</p>

<p> For instance, if a hash function has a range R(h) = 0&hellip;100, then you need to allocate an array of 100 (pointers-to) elements, even if you are just hashing 20 elements.</p></li>
<li><p><a href="http://stackoverflow.com/a/4128585">Inorder traverse</a>.</p></li>
<li><p>Collision might hamper HashMap&rsquo;s performance.</p></li>
<li><p><a href="http://stackoverflow.com/a/4129272">Resizing issue</a></p>

<p> When the hash table pressure grows too much, you often tend to enlargen and reallocate the hash table. The BST has simpler behavior here and does not tend to suddenly allocate a lot of data and do a rehashing operation.</p></li>
<li><p>Binary search tree do range searches efficiently.</p></li>
</ol>


<h3>One more thing</h3>

<p><strong>Trees tend to be the <a href="http://stackoverflow.com/a/19896875">ultimate average data structure</a></strong>. They can act as lists, can easily be split for parallel operation, have fast removal, insertion and lookup on the order of O(lgn). They do nothing particularly well, but they don&rsquo;t have any excessively bad behavior either.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/22/design-deck-card/">[CC150v5] 8.1 Design a Generic Deck of Cards</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-22T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/22/design-deck-card/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<blockquote><p>Design a Generic Deck of Cards</p></blockquote>

<h3>Solution</h3>

<p>A simple design:</p>

<pre><code>enum Suit {
    HEART, DIAMOND, SPADES, CLUBS;
}

class Deck {
    List&lt;Card&gt; deck;
}

class Card {
    Suit suit;
    int num;
}
</code></pre>

<p>A more complex design:</p>

<pre><code>enum Suit {
    HEART, DIAMOND, SPADES, CLUBS;
}

class Deck&lt;T extends Card&gt; {
    List&lt;Card&gt; deck;

    public void shuffle() {
    };
}

abstract class Card {
    boolean available;
    Suit suit;
    int num;

    public boolean isAvailable() {
        return available;
    };
}

class Hand&lt;T extends Card&gt; {
    List&lt;Card&gt; cards;

    public int score() {
        int score = 0;
        for (Card c : cards) {
            score += c.num;
        }
        return score;
    }

    public void addCard(T card) {
        cards.add(card);
    }
}

// Now use the above generic Data Structure to make a
// Blackjack Game
class Blackjack extends Hand&lt;BlackJackCard&gt; {
}

class BlackJackCard extends Card {
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/Talk-about-singleton/">[Java OOP] Singleton, 3 Implementations</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-20T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/20/Talk-about-singleton/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Implement Singlton</h3>

<p><a href="http://javarevisited.blogspot.sg/2012/07/why-enum-singleton-are-better-in-java.html">3 ways</a> of writing Singleton.</p>

<h4>using Enum</h4>

<p>This is only available since Java 6.</p>

<pre><code>public enum Singleton_Enum {
    INSTANCE;
}
</code></pre>

<h4>using double checked locking</h4>

<p>This is <strong>lazy loaded thread-safe</strong> Singleton, which is popular during Java 5 (with the use of Volatile variable).</p>

<pre><code>public class Singleton_DoubleCheckedLocking implements Cloneable {
    private static volatile Singleton_DoubleCheckedLocking INSTANCE;

    private Singleton_DoubleCheckedLocking() {
    }

    public static Singleton_DoubleCheckedLocking getInstance() {
        if (INSTANCE == null) {
            synchronized (Singleton_DoubleCheckedLocking.class) {
                // double checking Singleton instance
                if (INSTANCE == null) {
                    INSTANCE = new Singleton_DoubleCheckedLocking();
                }
            }
        }
        return INSTANCE;
    }
}
</code></pre>

<h4>using static factory method</h4>

<p>Singleton instance is <a href="http://javarevisited.blogspot.sg/2012/07/why-enum-singleton-are-better-in-java.html">static and final variable</a> it initialized when class is first loaded into memeory so creation of instance is inherently <strong>thread-safe</strong>.</p>

<pre><code>public class Singleton_StaticFactory {
    // initailzed during class loading
    private static final Singleton_StaticFactory INSTANCE = new Singleton_StaticFactory();

    // to prevent creating another instance of Singleton
    private Singleton_StaticFactory() {
    }

    public static Singleton_StaticFactory getSingleton() {
        return INSTANCE;
    }
}
</code></pre>

<h3>About thread-safety</h3>

<p><a href="http://javarevisited.blogspot.sg/2012/12/how-to-create-thread-safe-singleton-in-java-example.html">Prior to Java 5</a> <strong>double checked locking</strong> mechanism is used to create thread-safe singleton in Java, which breaks if one Thread doesn&rsquo;t see instance created by other thread at same time and eventually you will end up with more than one instance of Singleton class.</p>

<p>From Java 5 onwards <strong>volatile variable</strong> guarantee can be used to write thread safe singleton by using double checked locking pattern.</p>

<p>I personally don&rsquo;t prefer that way as there are many other simpler alternatives like:</p>

<ol>
<li>using static field</li>
<li>using Enum</li>
</ol>


<h3>Q &amp; A</h3>

<p>Question: How do you prevent for creating another instance of Singleton using clone() method?</p>

<p>Answer: Preferred way is not to implement Clonnable interface. And if you do, just throw Exception from clone() method as &ldquo;Can not create clone of Singleton class&rdquo;.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/Square-count-in-matchstick-graph/">[Question] Square Count of Matchstick Graph</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-20T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/20/Square-count-in-matchstick-graph/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<blockquote><p>给出下面这个图 设计数据结构和算法求出图中<strong>所有的正方形数量</strong> (count the number of squares).</p></blockquote>

<p><img class="middle" src="/assets/images/matchstick-square-count.jpg"></p>

<h3>Solution</h3>

<ol>
<li><p><strong>Pre-processing</strong>: 从每一个点开始存储上下左右四个方向最多延伸到的位置</p></li>
<li><p><strong>Main algorithm</strong>: 枚举右下角位置 然后枚举正方形边长</p></li>
<li><p>根据预处理的延伸情况判断是否能够有一个正方形被构造出来</p></li>
</ol>


<p>Total time complexity is O(n<sup>3</sup>).</p>

<blockquote><p>预处理可以O(n<sup>2</sup>) 预处理是有递推关系的</p>

<p>但是后面枚举的部分，只能O(n<sup>3</sup>)</p>

<p><strong>不能动态规划的原因是</strong>：他给定了一个可以变化的图，这个图上规模为n的图和规模为n-1的图中正方形个数之间不存在递推关系。</p></blockquote>

<p>And 一般来说处理矩阵的问题，大部分都是O(n<sup>3</sup>)</p>

<h3>Code</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/Dice-roll-DP-question/">[Question] Ways of Dice Throw</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-20T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/20/Dice-roll-DP-question/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<p><a href="http://www.geeksforgeeks.org/dice-throw-problem/">link</a></p>

<blockquote><p>Given n dice each with m faces, numbered from 1 to m, find the number of ways to get sum X. X is the summation of values on each face when all the dice are thrown.</p></blockquote>

<h3>Solution</h3>

<p><strong>DP</strong></p>

<blockquote><p>Sum(m, n, X) = Sum(m, n &ndash; 1, X &ndash; 1) +</p>

<pre><code>           Sum(m, n - 1, X - 2) +

           .................... + 

           Sum(m, n - 1, X - m)
</code></pre></blockquote>

<p>So we can have dp(n)(X) and for each, iterate m time. Total time is O(m * n * X).</p>

<h3>Code</h3>

<p><strong>not written by me</strong>.</p>

<pre><code>int findWays(int m, int n, int x)
{
    // Create a table to store results of subproblems.  One extra 
    // row and column are used for simpilicity (Number of dice
    // is directly used as row index and sum is directly used
    // as column index).  The entries in 0th row and 0th column
    // are never used.
    int table[n + 1][x + 1];
    memset(table, 0, sizeof(table)); // Initialize all entries as 0

    // Table entries for only one dice
    for (int j = 1; j &lt;= m &amp;&amp; j &lt;= x; j++)
        table[1][j] = 1;

    // Fill rest of the entries in table using recursive relation
    // i: number of dice, j: sum
    for (int i = 2; i &lt;= n; i++)
        for (int j = 1; j &lt;= x; j++)
            for (int k = 1; k &lt;= m &amp;&amp; k &lt; j; k++)
                table[i][j] += table[i-1][j-k];

    /* Uncomment these lines to see content of table
    for (int i = 0; i &lt;= n; i++)
    {
      for (int j = 0; j &lt;= x; j++)
        cout &lt;&lt; table[i][j] &lt;&lt; " ";
      cout &lt;&lt; endl;
    } */
    return table[n][x];
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/Count-set-bit-in-binary-number/">[Question] Count Set Bit in Binary Number</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-20T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/20/Count-set-bit-in-binary-number/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Question</h3>

<blockquote><p>Count Set Bit in Binary Number.</p>

<p>3 = 00000011 => 2</p>

<p>128 = 10000000 => 1</p></blockquote>

<h3>Solution</h3>

<p><strong>Bits counting algorithm</strong> (Brian Kernighan). Basic idea is <strong>clear 1 bit at a time</strong>.</p>

<p>This algorithm goes through as many iterations as there are set bits. In the worst case, it will pass once per bit. An integer n has log(n) bits, hence <a href="http://stackoverflow.com/a/12381102">the worst case</a> is O(log(n)).</p>

<h3>Code</h3>

<pre><code>public int countSetBit(String binary) {
    int num = Integer.parseInt(binary, 2);
    int count = 0;
    while (num != 0) {
        num &amp;= num - 1;
        count++;
    }
    return count;
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/19/singleton-pattern/">[Java OOP] Singleton Pattern Introduction</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-19T00:00:00+08:00" pubdate data-updated="true"></time>
        
         | <a href="/blog/2014/08/19/singleton-pattern/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Singleton Pattern</h3>

<p><strong>Singleton</strong> design pattern is one of the <strong>2 most frequent topics</strong> for OOD.</p>

<p><strong><a href="http://en.wikipedia.org/wiki/Singleton_pattern">Singleton pattern</a></strong> is a design pattern that restricts the instantiation of a class to one object.</p>

<h4>in Java</h4>

<p>Since Java 5.0, the easiest way to create a Singleton is the <strong><a href="http://en.wikipedia.org/wiki/Singleton_pattern#The_Enum_way">enum type approach</a></strong>. Here the code is not given.</p>

<p>We will instead cover a very popular implementation: <strong><a href="http://en.wikipedia.org/wiki/Singleton_pattern#Lazy_initialization">Lazy initialization</a></strong> using double-checked locking:</p>

<pre><code>public class SingletonDemo {
    private static volatile SingletonDemo instance = null;
    private SingletonDemo() { }
    public static SingletonDemo getInstance() {
        if (instance == null) {
            synchronized (SingletonDemo.class) {
                if (instance == null) {
                    instance = new SingletonDemo();
                }
            }
        }
        return instance;
    }
}
</code></pre>

<p>An alternate simpler and cleaner version may be used at the expense of potentially lower concurrency in a multithreaded environment:</p>

<pre><code>public class SingletonDemo {
    private static SingletonDemo instance = null;
    private SingletonDemo() { }
    public static synchronized SingletonDemo getInstance() {
        if (instance == null) {
            instance = new SingletonDemo();
        }
        return instance;
    }
}
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="28">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="26">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section class="well">
  <h1>Categories</h1>
  <ul id="categories" class="nav nav-list">
    <li class='category'><a href='/blog/categories/cc150v4/'>cc150v4 (34)</a></li>
<li class='category'><a href='/blog/categories/cc150v5/'>cc150v5 (28)</a></li>
<li class='category'><a href='/blog/categories/design/'>design (76)</a></li>
<li class='category'><a href='/blog/categories/experience/'>experience (4)</a></li>
<li class='category'><a href='/blog/categories/fundamental/'>fundamental (12)</a></li>
<li class='category'><a href='/blog/categories/java-oop/'>java oop (30)</a></li>
<li class='category'><a href='/blog/categories/leetcode/'>leetcode (176)</a></li>
<li class='category'><a href='/blog/categories/leetcode-plus/'>leetcode_plus (9)</a></li>
<li class='category'><a href='/blog/categories/lintcode/'>lintcode (11)</a></li>
<li class='category'><a href='/blog/categories/ninechap/'>ninechap (25)</a></li>
<li class='category'><a href='/blog/categories/q-facebook/'>q-facebook (9)</a></li>
<li class='category'><a href='/blog/categories/q-google/'>q-google (62)</a></li>
<li class='category'><a href='/blog/categories/question/'>question (123)</a></li>
<li class='category'><a href='/blog/categories/testing/'>testing (5)</a></li>
<li class='category'><a href='/blog/categories/z-string-search/'>z-string-search (17)</a></li>
<li class='category'><a href='/blog/categories/z-testing/'>z-testing (2)</a></li>
<li class='category'><a href='/blog/categories/z-top-k/'>z-top-k (6)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/09/02/Facebook-photo-storage/">[Design] Facebook Photo Storage </a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/30/how-google-search-works/">[Design] How Google search works </a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/30/design-class4-2/">[NineChap System Design] Class 4.2: Search Engine </a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/30/design-class4-1/">[NineChap System Design] Class 4.1: Crawler </a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/28/design-class3-2/">[NineChap System Design] Class 3.2: Web Service </a>
      </li>
    
  </ul>
</section>





<script type="text/javascript" src="http://srvpub.com/adServe/banners?tid=29011_41781_0&size=120x600" ></script>

<!--
<script type="text/javascript">
  ( function() {
    if (window.CHITIKA === undefined) { window.CHITIKA = { 'units' : [] }; };
    var unit = {"calltype":"async[2]","publisher":"willran168","width":160,"height":600,"sid":"Chitika Default"};
    var placement_id = window.CHITIKA.units.length;
    window.CHITIKA.units.push(unit);
    document.write('<div id="chitikaAdBlock-' + placement_id + '"></div>');
}());
</script>
<script type="text/javascript" src="//cdn.chitika.net/getads.js" async></script>
&#8211;>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy; 2015 - <a href="/about">CodeMonkey</a> -  All posts are my original writing, based uppon my personal view. <a href="/policy">Privacy Policy</a> - 
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'woodstockblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
